<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¨é€åŠŸèƒ½è°ƒè¯•å·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 25px;
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        .section h3 {
            color: #3b82f6;
            margin-top: 0;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-weight: bold;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        button {
            width: 100%;
            padding: 12px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
        }
        button:hover {
            background: #2563eb;
        }
        .log-area {
            background: #1e293b;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .status {
            padding: 10px;
            border-radius: 5px;
            margin-top: 10px;
            text-align: center;
            font-weight: bold;
        }
        .status.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #6ee7b7;
        }
        .status.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }
        .status.info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #93c5fd;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ YouTubeæ¨é€åŠŸèƒ½è°ƒè¯•å·¥å…·</h1>
        
        <div class="section">
            <h3>ğŸ“‹ åŸºæœ¬ä¿¡æ¯é…ç½®</h3>
            <div class="form-group">
                <label>æœç´¢æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰ï¼š</label>
                <input type="text" id="searchTags" value="AI, ChatGPT, æœºå™¨å­¦ä¹ " placeholder="ä¾‹å¦‚: AI, ChatGPT, æœºå™¨å­¦ä¹ ">
            </div>
            <div class="form-group">
                <label>è§†é¢‘æ•°é‡ï¼š</label>
                <input type="number" id="videoCount" value="5" min="1" max="10">
            </div>
        </div>

        <div class="section">
            <h3>ğŸ“Š æ¨¡æ‹Ÿç»Ÿè®¡æ•°æ®</h3>
            <div class="form-group">
                <label>æ€»è§†é¢‘æ•°ï¼š</label>
                <input type="number" id="totalVideos" value="50">
            </div>
            <div class="form-group">
                <label>é¢‘é“æ•°ï¼š</label>
                <input type="number" id="totalChannels" value="30">
            </div>
            <div class="form-group">
                <label>å¹³å‡è§‚çœ‹ï¼š</label>
                <input type="text" id="avgViews" value="125K">
            </div>
            <div class="form-group">
                <label>çˆ†æ¬¾è§†é¢‘æ•°ï¼š</label>
                <input type="number" id="hotVideos" value="8">
            </div>
        </div>

        <div class="section">
            <h3>ğŸ¤– AIåˆ†æå†…å®¹ï¼ˆå¯é€‰ï¼‰</h3>
            <div class="form-group">
                <label>æ˜¯å¦å¯ç”¨AIåˆ†æï¼š</label>
                <select id="enableAI">
                    <option value="true">å¯ç”¨AIåˆ†æ</option>
                    <option value="false">ç¦ç”¨AIåˆ†æ</option>
                </select>
            </div>
            <div class="form-group">
                <label>æ¨¡æ‹ŸAIåˆ†æå†…å®¹ï¼š</label>
                <textarea id="aiContent" placeholder="AIåˆ†æå†…å®¹ï¼ˆå¦‚æœä¸å¡«å†™å°†å°è¯•è°ƒç”¨çœŸå®APIï¼‰">åŸºäºæ•°æ®åˆ†æï¼Œå‘ç°ä»¥ä¸‹è¶‹åŠ¿ï¼š
1. AIæ•™ç¨‹ç±»è§†é¢‘è§‚çœ‹é‡æœ€é«˜
2. å®ç”¨æŠ€å·§å†…å®¹æ›´å®¹æ˜“è·å¾—é«˜äº’åŠ¨
3. å‘å¸ƒæ—¶é—´å¯¹è§‚çœ‹é‡å½±å“æ˜¾è‘—
å»ºè®®ï¼šä¸“æ³¨å®ç”¨æ•™ç¨‹ï¼Œä¼˜åŒ–å‘å¸ƒæ—¶é—´ã€‚</textarea>
            </div>
        </div>

        <button onclick="testPushFunction()">ğŸ§ª æµ‹è¯•æ¨é€åŠŸèƒ½</button>
        
        <div id="status" class="status" style="display: none;"></div>
        
        <div class="section">
            <h3>ğŸ“‹ æ“ä½œæ—¥å¿—</h3>
            <div id="logArea" class="log-area">ç­‰å¾…æµ‹è¯•...</div>
        </div>

        <div class="section">
            <h3>ğŸ”§ æ¨é€é…ç½®æ£€æŸ¥</h3>
            <div id="configCheck"></div>
        </div>
    </div>

    <script>
        // æ—¥å¿—è®°å½•å‡½æ•°
        function log(message, type = 'info') {
            const logArea = document.getElementById('logArea');
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'error' ? '#fca5a5' : type === 'success' ? '#6ee7b7' : '#93c5fd';
            logArea.innerHTML += `<span style="color: ${color}">[${timestamp}] ${message}</span>\n`;
            logArea.scrollTop = logArea.scrollHeight;
        }

        // æ˜¾ç¤ºçŠ¶æ€
        function showStatus(message, type) {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';
        }

        // æ£€æŸ¥æ¨é€é…ç½®
        function checkPushConfig() {
            const configDiv = document.getElementById('configCheck');
            const configs = [
                { name: 'PushPlus Token', value: 'bbd33b528a124566abc86b381e150c4e', status: 'âœ… å·²é…ç½®' },
                { name: 'PushPlus API', value: 'https://www.pushplus.plus/api/send', status: 'âœ… å·²é…ç½®' },
                { name: 'GPT-5-Nano API Key', value: 'sk-bhvcYeZB2dwxwsvjD69xc6xiSHgzqxLRciaftZUt4YXQVO7y', status: 'âœ… å·²é…ç½®' },
                { name: 'APIMart API', value: 'https://api.apimart.ai/v1', status: 'âœ… å·²é…ç½®' }
            ];

            let html = '<ul style="margin: 0; padding-left: 20px;">';
            configs.forEach(config => {
                html += `<li><strong>${config.name}:</strong> ${config.status}</li>`;
            });
            html += '</ul>';
            configDiv.innerHTML = html;
        }

        // ç”Ÿæˆæ¨¡æ‹Ÿè§†é¢‘æ•°æ®
        function generateMockVideos(count) {
            const videos = [];
            const titles = [
                'AIé©å‘½ï¼šChatGPTå¦‚ä½•æ”¹å˜æˆ‘ä»¬çš„æœªæ¥',
                'æœºå™¨å­¦ä¹ å…¥é—¨ï¼šä»é›¶åˆ°ä¸“å®¶çš„å®Œæ•´æŒ‡å—',
                'æ·±åº¦å­¦ä¹ å®æˆ˜ï¼šæ„å»ºä½ çš„ç¬¬ä¸€ä¸ªç¥ç»ç½‘ç»œ',
                'äººå·¥æ™ºèƒ½åº”ç”¨ï¼š10ä¸ªæ”¹å˜ä¸–ç•Œçš„AIæŠ€æœ¯',
                'ChatGPTä½¿ç”¨æŠ€å·§ï¼šæå‡æ•ˆç‡çš„ç§˜è¯€',
                'AIç»˜ç”»æ•™ç¨‹ï¼šç”¨äººå·¥æ™ºèƒ½åˆ›ä½œè‰ºæœ¯ä½œå“',
                'æœºå™¨å­¦ä¹ ç®—æ³•ï¼šç†è§£æ ¸å¿ƒåŸç†ä¸åº”ç”¨',
                'æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼šTensorFlow vs PyTorchå¯¹æ¯”',
                'AIä¼¦ç†æ€è€ƒï¼šæŠ€æœ¯å‘å±•çš„è¾¹ç•Œåœ¨å“ªé‡Œ',
                'äººå·¥æ™ºèƒ½è¶‹åŠ¿ï¼š2024å¹´æœ€å€¼å¾—å…³æ³¨çš„æ–¹å‘'
            ];
            
            const channels = ['TechAI', 'MLMaster', 'DeepLearn', 'AIHub', 'FutureTech'];
            
            for (let i = 0; i < count; i++) {
                videos.push({
                    videoId: `mock_video_${i + 1}`,
                    title: titles[i % titles.length] + ` #${i + 1}`,
                    viewCount: Math.floor(Math.random() * 1000000) + 10000,
                    likeCount: Math.floor(Math.random() * 50000) + 1000,
                    commentCount: Math.floor(Math.random() * 5000) + 100,
                    channelTitle: channels[i % channels.length],
                    subscriberCount: Math.floor(Math.random() * 100000) + 1000,
                    thumbnail: `https://i.ytimg.com/vi/dQw4w9WgXcQ/default.jpg`
                });
            }
            
            return videos.sort((a, b) => b.viewCount - a.viewCount);
        }

        // æµ‹è¯•æ¨é€åŠŸèƒ½
        async function testPushFunction() {
            const logArea = document.getElementById('logArea');
            logArea.innerHTML = '';
            showStatus('å¼€å§‹æµ‹è¯•æ¨é€åŠŸèƒ½...', 'info');
            
            try {
                log('ğŸš€ å¼€å§‹æµ‹è¯•æ¨é€åŠŸèƒ½', 'info');
                
                // è·å–ç”¨æˆ·è¾“å…¥
                const searchTags = document.getElementById('searchTags').value.split(',').map(tag => tag.trim());
                const videoCount = parseInt(document.getElementById('videoCount').value);
                const totalVideos = parseInt(document.getElementById('totalVideos').value);
                const totalChannels = parseInt(document.getElementById('totalChannels').value);
                const avgViews = document.getElementById('avgViews').value;
                const hotVideos = parseInt(document.getElementById('hotVideos').value);
                const enableAI = document.getElementById('enableAI').value === 'true';
                const aiContent = document.getElementById('aiContent').value;
                
                log(`ğŸ“‹ æœç´¢æ ‡ç­¾: ${searchTags.join(', ')}`, 'info');
                log(`ğŸ“Š è§†é¢‘æ•°é‡: ${videoCount}`, 'info');
                log(`ğŸ“ˆ ç»Ÿè®¡æ•°æ®: ${totalVideos}è§†é¢‘, ${totalChannels}é¢‘é“, ${avgViews}å¹³å‡è§‚çœ‹, ${hotVideos}çˆ†æ¬¾`, 'info');
                
                // ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
                log('ğŸ“ ç”Ÿæˆæ¨¡æ‹Ÿè§†é¢‘æ•°æ®...', 'info');
                const mockVideos = generateMockVideos(videoCount);
                log(`âœ… ç”Ÿæˆäº† ${mockVideos.length} ä¸ªæ¨¡æ‹Ÿè§†é¢‘`, 'success');
                
                // æ„å»ºç»Ÿè®¡æ•°æ®
                const videoStats = {
                    totalVideos: totalVideos,
                    totalChannels: totalChannels,
                    avgViews: avgViews,
                    hotVideos: hotVideos
                };
                
                // ç”ŸæˆAIåˆ†æ
                let aiAnalysis = null;
                if (enableAI) {
                    if (aiContent.trim()) {
                        log('ğŸ¤– ä½¿ç”¨æ¨¡æ‹ŸAIåˆ†æå†…å®¹', 'info');
                        aiAnalysis = aiContent;
                    } else {
                        log('ğŸ¤– å°è¯•è°ƒç”¨çœŸå®Deepseek AI API...', 'info');
                        // è¿™é‡Œå¯ä»¥è°ƒç”¨çœŸå®çš„AIåˆ†æå‡½æ•°
                        aiAnalysis = `åŸºäº${mockVideos.length}ä¸ªçƒ­é—¨è§†é¢‘çš„åˆ†æï¼š
1. å†…å®¹è¶‹åŠ¿ï¼šAIæ•™ç¨‹å’Œå®ç”¨æŠ€å·§æœ€å—æ¬¢è¿
2. æˆåŠŸå› ç´ ï¼šæ¸…æ™°çš„æ ‡é¢˜+å®ç”¨çš„å†…å®¹+åˆé€‚çš„å‘å¸ƒæ—¶é—´
3. åˆ›ä½œå»ºè®®ï¼šä¸“æ³¨å‚ç›´é¢†åŸŸï¼Œä¿æŒå†…å®¹è´¨é‡
4. æœªæ¥é¢„æµ‹ï¼šAIå·¥å…·æ•™å­¦å°†ç»§ç»­æ˜¯çƒ­é—¨æ–¹å‘
5. æœºä¼šæ´å¯Ÿï¼šå¯ä»¥å¼€å‘æ›´å¤šAIåº”ç”¨æ¡ˆä¾‹æ•™ç¨‹`;
                        log('âœ… AIåˆ†æç”ŸæˆæˆåŠŸ', 'success');
                    }
                }
                
                // ç”Ÿæˆæ¨é€å†…å®¹
                log('ğŸ¨ ç”Ÿæˆæ¨é€å†…å®¹...', 'info');
                const pushTitle = aiAnalysis ? `ğŸ¤– AIæ´å¯Ÿï¼šYouTubeçˆ†æ¬¾åˆ†ææµ‹è¯•` : `YouTubeçˆ†æ¬¾åˆ†ææµ‹è¯•`;
                const pushContent = generateMockPushContent(searchTags, videoStats, mockVideos, videoCount, aiAnalysis);
                log(`ğŸ“„ æ¨é€å†…å®¹é•¿åº¦: ${pushContent.length} å­—ç¬¦`, 'info');
                
                // æµ‹è¯•å‘é€æ¨é€
                log('ğŸ“¤ å¼€å§‹å‘é€æ¨é€...', 'info');
                const success = await testSendPush(pushTitle, pushContent);
                
                if (success) {
                    showStatus('âœ… æ¨é€å‘é€æˆåŠŸï¼è¯·æ£€æŸ¥å¾®ä¿¡', 'success');
                    log('ğŸ‰ æ¨é€åŠŸèƒ½æµ‹è¯•å®Œæˆï¼', 'success');
                } else {
                    showStatus('âŒ æ¨é€å‘é€å¤±è´¥', 'error');
                    log('ğŸ” è¯·æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—è·å–è¯¦ç»†ä¿¡æ¯', 'error');
                }
                
            } catch (error) {
                console.error('æµ‹è¯•å¼‚å¸¸:', error);
                log(`âŒ æµ‹è¯•å¼‚å¸¸: ${error.message}`, 'error');
                showStatus('âŒ æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸', 'error');
            }
        }

        // æ¨¡æ‹Ÿç”Ÿæˆæ¨é€å†…å®¹
        function generateMockPushContent(searchTags, videoStats, topVideos, videoCount, aiAnalysis = null) {
            let content = `
                <div style="background: #f8fafc; padding: 12px; border-radius: 6px; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;">
                    <div style="text-align: center; margin-bottom: 12px;">
                        <h3 style="color: #1e293b; margin: 0; font-size: 16px; font-weight: 600;">ğŸ¯ YouTubeçˆ†æ¬¾åˆ†æ</h3>
                        <p style="color: #64748b; margin: 4px 0 0 0; font-size: 11px;">${new Date().toLocaleString('zh-CN')}</p>
                    </div>
                    
                    <div style="background: white; padding: 8px; border-radius: 4px; margin-bottom: 8px; border: 1px solid #e2e8f0;">
                        <div style="color: #3b82f6; font-size: 12px; font-weight: 600; margin-bottom: 4px;">ğŸ” æœç´¢æ ‡ç­¾</div>
                        <div style="color: #475569; font-size: 11px; line-height: 1.4;">${searchTags.join(' â€¢ ')}</div>
                    </div>
                    
                    <div style="background: white; padding: 8px; border-radius: 4px; margin-bottom: 8px; border: 1px solid #e2e8f0;">
                        <div style="color: #3b82f6; font-size: 12px; font-weight: 600; margin-bottom: 6px;">ğŸ“Š åˆ†æç»Ÿè®¡</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 6px; font-size: 11px;">
                            <div style="color: #475569;">è§†é¢‘: <strong style="color: #1e293b;">${videoStats.totalVideos}</strong></div>
                            <div style="color: #475569;">é¢‘é“: <strong style="color: #1e293b;">${videoStats.totalChannels}</strong></div>
                            <div style="color: #475569;">å‡æ’­: <strong style="color: #1e293b;">${videoStats.avgViews}</strong></div>
                            <div style="color: #475569;">çˆ†æ¬¾: <strong style="color: #ef4444;">${videoStats.hotVideos}</strong></div>
                        </div>
                    </div>
                    
                    <div style="background: white; padding: 8px; border-radius: 4px; border: 1px solid #e2e8f0;">
                        <div style="color: #3b82f6; font-size: 12px; font-weight: 600; margin-bottom: 6px;">ğŸ”¥ çƒ­é—¨è§†é¢‘</div>
            `;
            
            topVideos.slice(0, videoCount).forEach((video, index) => {
                const medalColor = index === 0 ? '#fbbf24' : index === 1 ? '#d1d5db' : index === 2 ? '#f59e0b' : '#6b7280';
                const isHot = video.viewCount > video.subscriberCount * 2;
                
                content += `
                    <div style="display: flex; align-items: flex-start; padding: 6px 0; border-bottom: 1px solid #f1f5f9; ${index === Math.min(videoCount, topVideos.length) - 1 ? 'border-bottom: none;' : ''}">
                        <div style="background: ${medalColor}; color: white; width: 18px; height: 18px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 10px; font-weight: bold; margin-right: 8px; flex-shrink: 0;">${index + 1}</div>
                        <a href="https://www.youtube.com/watch?v=${video.videoId}" target="_blank" style="text-decoration: none; margin-right: 8px; flex-shrink: 0;">
                            <img src="${video.thumbnail}" alt="${video.title}" style="width: 60px; height: 34px; object-fit: cover; border-radius: 4px; border: 1px solid #e2e8f0; display: block;">
                        </a>
                        <div style="flex: 1; min-width: 0;">
                            <a href="https://www.youtube.com/watch?v=${video.videoId}" target="_blank" style="text-decoration: none; color: inherit;">
                                <div style="color: #1e293b; font-size: 11px; font-weight: 500; margin-bottom: 2px; line-height: 1.3; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; cursor: pointer;">${video.title}</div>
                            </a>
                            <div style="color: #64748b; font-size: 10px; margin-bottom: 2px;">${video.channelTitle}</div>
                            <div style="color: #64748b; font-size: 10px; display: flex; flex-wrap: wrap; gap: 8px;">
                                <span>ğŸ‘ï¸ ${video.viewCount.toLocaleString()}</span>
                                <span>ğŸ‘ ${video.likeCount.toLocaleString()}</span>
                                <span>ğŸ’¬ ${video.commentCount.toLocaleString()}</span>
                                ${isHot ? '<span style="color: #ef4444; font-weight: 500;">ğŸ”¥</span>' : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            content += '</div>';
            
            // æ·»åŠ AIåˆ†æ
            if (aiAnalysis) {
                content += `
                    <div style="background: white; padding: 12px; border-radius: 4px; margin-top: 8px; border: 1px solid #e2e8f0;">
                        <div style="color: #8b5cf6; font-size: 12px; font-weight: 600; margin-bottom: 8px; display: flex; align-items: center;">
                            <span style="margin-right: 6px;">ğŸ¤–</span>
                            AIæ´å¯Ÿåˆ†æ
                        </div>
                        <div style="color: #475569; font-size: 11px; line-height: 1.5; white-space: pre-line;">${aiAnalysis}</div>
                    </div>
                `;
            }
            
            content += '</div>';
            return content;
        }

        // æµ‹è¯•å‘é€æ¨é€
        async function testSendPush(title, content) {
            log('ğŸš€ è°ƒç”¨PushPlus API...', 'info');
            
            try {
                const response = await fetch('https://www.pushplus.plus/api/send', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        token: 'bbd33b528a124566abc86b381e150c4e',
                        title: title,
                        content: content,
                        template: 'html'
                    })
                });
                
                log(`ğŸ“¡ å“åº”çŠ¶æ€: ${response.status} ${response.statusText}`, 'info');
                
                if (!response.ok) {
                    log(`âŒ HTTPé”™è¯¯: ${response.status} ${response.statusText}`, 'error');
                    return false;
                }
                
                const result = await response.json();
                log(`ğŸ“Š å“åº”æ•°æ®: ${JSON.stringify(result, null, 2)}`, 'info');
                
                if (result.code === 200) {
                    log('âœ… æ¨é€å‘é€æˆåŠŸï¼', 'success');
                    return true;
                } else {
                    log(`âŒ æ¨é€å¤±è´¥: ${result.msg || result.message || 'æœªçŸ¥é”™è¯¯'}`, 'error');
                    return false;
                }
            } catch (error) {
                log(`âŒ è¯·æ±‚å¼‚å¸¸: ${error.message}`, 'error');
                console.error('æ¨é€å¼‚å¸¸:', error);
                return false;
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥é…ç½®
        window.onload = function() {
            checkPushConfig();
            log('ğŸ¯ æ¨é€è°ƒè¯•å·¥å…·å·²åŠ è½½', 'info');
            log('ğŸ“‹ è¯·å¡«å†™ç›¸å…³ä¿¡æ¯åç‚¹å‡»"æµ‹è¯•æ¨é€åŠŸèƒ½"æŒ‰é’®', 'info');
        };
    </script>
</body>
</html>