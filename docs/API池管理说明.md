# 🔑 API池管理系统使用说明

## 📌 概述

现在所有工具（低粉爆款挖掘、博主管理、视频监控）都使用**统一的API池管理系统**！

### ✨ 主要特性

- ✅ **统一管理**：三个工具共享同一个API池
- ✅ **手动添加**：可以添加单个API Key
- ✅ **批量导入**：支持一次导入多个API Key
- ✅ **状态管理**：自动追踪API配额使用情况
- ✅ **工具互通**：在任何工具中都能看到最新的API池状态
- ✅ **智能切换**：配额用尽时自动切换到下一个可用API

---

## 🚀 快速开始

### 第一步：打开API池管理工具

1. 打开 `API池管理工具.html`
2. 你会看到API池管理界面

### 第二步：添加API Key

#### 方法A：手动添加单个API

1. 在"单个API Key"输入框中粘贴你的API Key
2. 点击"➕ 添加单个"按钮
3. 系统会自动验证格式并添加

#### 方法B：批量导入多个API

1. 在"批量API Keys"文本框中粘贴多个API Key（每行一个）
   ```
   AIzaSyC1vB2nM3qR4sT5uV6wX7yZ8aB9cD0eF1g
   AIzaSyD2wC3oN4rS5tU6vW7xY8zA9bC0dE1fG2h
   AIzaSyE3xD4pO5sT6uV7wX8yZ9aB0cD1eF2gH3i
   ```
2. 点击"📥 批量导入"按钮
3. 系统会自动过滤重复和无效的API Key

### 第三步：查看统计信息

顶部统计栏显示：
- **总API数**：池中API的总数量
- **可用**：当前可以使用的API数量
- **已用尽**：配额已耗尽的API数量
- **已禁用**：手动禁用的API数量

### 第四步：使用工具

1. 打开任一工具（01/02/03）
2. 工具会自动从API池中加载可用的API
3. 界面顶部显示当前API池状态
4. 无需手动配置，直接开始使用！

---

## 🎯 API状态管理

### 三种状态

1. **✅ 可用（active）**
   - API Key正常可用
   - 工具会自动使用这些API

2. **⚠️ 配额用尽（exhausted）**
   - API配额已耗尽
   - 工具会自动跳过这些API
   - 可以手动重置状态

3. **🚫 已禁用（disabled）**
   - 手动禁用的API
   - 工具不会使用这些API

### 状态切换

在API池管理工具中：
- 点击"🚫 禁用"按钮：将可用API设为禁用
- 点击"✅ 启用"按钮：将禁用/用尽的API设为可用

### 重置配额

每天YouTube API配额会自动重置，你可以：
1. 点击"🔄 重置所有状态"按钮
2. 所有"配额用尽"的API会变回"可用"状态

---

## 🔄 工作流程

### 正常使用流程

```
1. 在API池管理工具中添加API Key
   ↓
2. 打开任一工具（01/02/03）
   ↓
3. 工具自动加载API池
   ↓
4. 开始使用工具功能
   ↓
5. API配额用尽时自动切换
```

### 配额用尽后

```
工具检测到配额超限
   ↓
自动标记当前API为"已用尽"
   ↓
自动切换到下一个可用API
   ↓
继续执行任务（如果有可用API）
```

---

## 💡 实用技巧

### 1. 准备充足的API

- 建议至少准备 **3-5个** API Key
- 每个API每天有 10,000 配额单位
- 多个API可以大大延长使用时间

### 2. 定期检查状态

- 定期打开API池管理工具查看状态
- 及时重置"配额用尽"的API
- 添加新的备用API

### 3. 导出备份

- 点击"📤 导出API列表"保存备份
- 防止意外丢失API Key
- 方便在其他设备上导入

### 4. 混合使用

- API池：用于自动管理和切换
- 自定义API：用于临时测试或特殊需求
- 可以随时在两种模式间切换

---

## 🛠️ 常见操作

### 添加单个API

```javascript
1. 复制API Key
2. 粘贴到"单个API Key"输入框
3. 点击"➕ 添加单个"
```

### 批量导入API

```javascript
1. 准备多个API Key（每行一个）
2. 粘贴到"批量API Keys"文本框
3. 点击"📥 批量导入"
4. 查看导入结果统计
```

### 删除API

```javascript
1. 找到要删除的API卡片
2. 点击"🗑️ 删除"按钮
3. 确认删除
```

### 禁用/启用API

```javascript
1. 找到目标API卡片
2. 点击"🚫 禁用"或"✅ 启用"按钮
3. 状态立即生效
```

### 重置配额

```javascript
1. 点击顶部"🔄 重置所有状态"按钮
2. 确认操作
3. 所有"已用尽"API变为"可用"
```

---

## 📊 配额使用参考

| 操作 | 配额消耗 | 单API日限 |
|------|---------|----------|
| 搜索视频 | 100单位 | ~100次 |
| 获取频道信息 | 1单位 | ~10,000次 |
| 获取视频详情 | 1单位 | ~10,000次 |
| 获取视频列表 | 1单位 | ~10,000次 |

### 实际使用估算

- **01 低粉爆款挖掘**：每次搜索约消耗 100-150 单位
- **02 博主管理**：每个博主约消耗 1-2 单位
- **03 视频监控**：每个博主每次约消耗 2-5 单位

### 多API组合

- **3个API**：每天约 300 次搜索 或 30,000 次频道查询
- **5个API**：每天约 500 次搜索 或 50,000 次频道查询
- **10个API**：每天约 1,000 次搜索 或 100,000 次频道查询

---

## ⚠️ 注意事项

### 安全性

1. **不要分享API Key**
   - API Key是敏感信息
   - 不要将包含真实API的文件公开分享
   - 使用"导出API列表"功能时注意文件存储位置

2. **设置使用限制**
   - 在Google Cloud Console中限制API使用范围
   - 可选：设置IP地址限制
   - 可选：设置每日请求上限

### 数据安全

1. **定期备份**
   - 使用"导出API列表"功能定期备份
   - 同时备份博主数据（在博主管理工具中）
   - 保存在安全的位置

2. **浏览器数据**
   - API池存储在浏览器IndexedDB中
   - 清除浏览器数据会删除API池
   - 重装系统前记得导出备份

### 配额管理

1. **合理使用**
   - 避免短时间内大量请求
   - 使用筛选条件减少不必要的查询
   - 批量操作时适当延时

2. **配额重置**
   - YouTube API配额每天午夜（太平洋时间）重置
   - 约北京时间 15:00-16:00 重置
   - 重置后记得在API池管理工具中点击"重置所有状态"

---

## 🔧 故障排除

### 问题1：工具显示"0 可用"

**原因**：
- API池中没有API
- 所有API都已禁用或用尽

**解决方案**：
1. 打开"API池管理工具.html"
2. 添加新的API Key
3. 或点击"重置所有状态"恢复已用尽的API
4. 刷新工具页面

### 问题2：添加API失败

**原因**：
- API格式不正确
- API已存在

**解决方案**：
1. 检查API格式（应以"AIzaSy"开头，共39字符）
2. 查看是否已在列表中
3. 确认复制时没有多余空格

### 问题3：自动切换不工作

**原因**：
- 所有API都已用尽
- IndexedDB未正确更新

**解决方案**：
1. 打开API池管理工具查看状态
2. 添加新的API或重置配额
3. 刷新浏览器

### 问题4：三个工具API不同步

**原因**：
- 浏览器缓存问题
- IndexedDB未刷新

**解决方案**：
1. 刷新所有工具页面（F5）
2. 如果问题persist，清除浏览器缓存
3. 重新打开API池管理工具验证

---

## 📝 更新日志

### v3.0 (2025-10-15)
- ✅ 创建统一的API池管理系统
- ✅ 支持手动添加和批量导入
- ✅ 三个工具共享API池
- ✅ 自动状态追踪和切换
- ✅ 可视化管理界面

### v2.0
- ✅ 内置API池自动切换
- ✅ 配额检测功能

### v1.0
- ✅ 基础工具功能

---

## 🎉 开始使用

1. ✅ 打开 `API池管理工具.html`
2. ✅ 添加你的API Keys
3. ✅ 打开任一工具开始使用
4. ✅ 享受无缝的API管理体验！

---

**提示**：如有问题，请检查浏览器控制台（F12）查看详细错误信息。

**支持**：所有工具都已更新支持新的API池系统，无需额外配置！

